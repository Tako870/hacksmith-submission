{% extends 'base.html' %}

{% block title %}Map of Asset Network{% endblock %}

{% block header %}
<h1>Map of Asset Network</h1>
{% endblock %}

{% block content %}

<p>
	This page will display a visual representation of the asset network based
	on the uploaded JSON map. Vulnerabilities won't be highlighted on this base view.
</p>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
	{% for category, message in messages %}
	  <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show" role="alert">
		{{ message }}
		<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
	  </div>
	{% endfor %}
  {% endif %}
{% endwith %}

<div id="map-container" style="display: flex; gap: 16px; margin-top: 20px">
	<!-- Graph container -->
	<div
		id="network"
		style="
			flex: 3;
			height: 75vh;
			border: 1px solid #ccc;
			border-radius: 6px;
			position: relative;
		"
	>
		<!-- Legend overlay -->
		<div
			id="legend"
			style="
				position: absolute;
				top: 10px;
				left: 10px;
				padding: 10px;
				background: rgba(255, 255, 255, 0.85);
				border-radius: 6px;
				font-size: 0.8rem;
				border: 1px solid #bbb;
			"
		>
			<strong>Edge Legend</strong><br /><br />
			<div style="font-size:0.85rem;color:#222">(Colored edges show relation types)</div>
		</div>
	</div>

	<!-- Info box -->
	<div
		id="node-info"
		style="
			flex: 1;
			height: 75vh;
			border: 1px solid #ccc;
			border-radius: 6px;
			padding: 12px;
			font-size: 0.9rem;
			overflow-y: auto;
			background: #f9fafb;
		"
	>
		<h3 style="margin-top: 0">Node Info</h3>
		<p>Click a node in the graph to pin its details here.</p>
	</div>
</div>

<!-- vis-network CDN -->
<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>

<script src="{{ url_for('static', filename='renderMap.js') }}"></script>

{% endblock %}

